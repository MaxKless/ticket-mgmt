<h2>Ticket Details</h2>

<div *ngIf="ticket$ | async as ticket">
  <h3>Ticket ID: {{ ticket.id }}</h3>
  <h3>Ticket Description: {{ ticket.description }}</h3>
  <!-- TODO: reset completed state-->
  <h3>Completed: {{ ticket.completed }}</h3>
  <button mat-button (click)="toggleCompletion(ticket)">
    {{ ticket.completed ? "Mark as incomplete" : "Mark as completed" }}
  </button>
  <ng-container *ngIf="!editingAssignee; else editing">
    <h3 id="ticketname">Ticket Assignee: {{ ticket.name }}</h3>
    <button mat-button (click)="editingAssignee = true">Edit Assignee</button>
  </ng-container>
  <ng-template #editing>
    <form>
      <mat-form-field appearance="fill">
        <mat-label>Assignee</mat-label>
        <mat-select [formControl]="newAssignee" id="newAssignee">
          <mat-option *ngFor="let user of users$ | async" [value]="user.id">
            {{ user.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </form>
    <button mat-button (click)="finalizeUpdate()">Update</button>
    <button mat-button (click)="editingAssignee = false">Cancel</button>
  </ng-template>
</div>
